{"ast":null,"code":"import _regeneratorRuntime from \"/Users/devinajimine/Desktop/reactApp/notes-app-client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/devinajimine/Desktop/reactApp/notes-app-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/devinajimine/Desktop/reactApp/notes-app-client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/devinajimine/Desktop/reactApp/notes-app-client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/devinajimine/Desktop/reactApp/notes-app-client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/devinajimine/Desktop/reactApp/notes-app-client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/devinajimine/Desktop/reactApp/notes-app-client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/devinajimine/Desktop/reactApp/notes-app-client/src/components/FacebookButton.js\";\nimport React, { Component } from \"react\";\nimport { Auth } from \"aws-amplify\";\nimport LoaderButton from \"./LoaderButton\";\n\nfunction waitForInit() {\n  return new Promise(function (res, rej) {\n    var hasFbLoaded = function hasFbLoaded() {\n      if (window.FB) {\n        res();\n      } else {\n        setTimeout(hasFbLoaded, 300);\n      }\n    };\n\n    hasFbLoaded();\n  });\n}\n\nvar FacebookButton =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(FacebookButton, _Component);\n\n  function FacebookButton(props) {\n    var _this;\n\n    _classCallCheck(this, FacebookButton);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(FacebookButton).call(this, props));\n\n    _this.statusChangeCallback = function (response) {\n      if (response.status === \"connected\") {\n        _this.handleResponse(response.authResponse);\n      } else {\n        _this.handleError(response);\n      }\n    };\n\n    _this.checkLoginState = function () {\n      window.FB.getLoginStatus(_this.statusChangeCallback);\n    };\n\n    _this.handleClick = function () {\n      window.FB.login(_this.checkLoginState, {\n        scope: \"public_profile,email\"\n      });\n    };\n\n    _this.state = {\n      isLoading: true\n    };\n    return _this;\n  }\n\n  _createClass(FacebookButton, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return waitForInit();\n\n              case 2:\n                this.setState({\n                  isLoading: false\n                });\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"handleError\",\n    value: function handleError(error) {\n      alert(error);\n    }\n  }, {\n    key: \"handleResponse\",\n    value: function () {\n      var _handleResponse = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(data) {\n        var email, token, expiresIn, expires_at, user, response;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                email = data.email, token = data.accessToken, expiresIn = data.expiresIn;\n                expires_at = expiresIn * 1000 + new Date().getTime();\n                user = {\n                  email: email\n                };\n                this.setState({\n                  isLoading: true\n                });\n                _context2.prev = 4;\n                _context2.next = 7;\n                return Auth.federatedSignIn(\"facebook\", {\n                  token: token,\n                  expires_at: expires_at\n                }, user);\n\n              case 7:\n                response = _context2.sent;\n                this.setState({\n                  isLoading: false\n                });\n                this.props.onLogin(response);\n                _context2.next = 16;\n                break;\n\n              case 12:\n                _context2.prev = 12;\n                _context2.t0 = _context2[\"catch\"](4);\n                this.setState({\n                  isLoading: false\n                });\n                this.handleError(_context2.t0);\n\n              case 16:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[4, 12]]);\n      }));\n\n      return function handleResponse(_x) {\n        return _handleResponse.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(LoaderButton, {\n        block: true,\n        bsSize: \"large\",\n        bsStyle: \"primary\",\n        className: \"FacebookButton\",\n        text: \"Login with Facebook\",\n        onClick: this.handleClick,\n        disabled: this.state.isLoading,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return FacebookButton;\n}(Component);\n\nexport { FacebookButton as default };","map":{"version":3,"sources":["/Users/devinajimine/Desktop/reactApp/notes-app-client/src/components/FacebookButton.js"],"names":["React","Component","Auth","LoaderButton","waitForInit","Promise","res","rej","hasFbLoaded","window","FB","setTimeout","FacebookButton","props","statusChangeCallback","response","status","handleResponse","authResponse","handleError","checkLoginState","getLoginStatus","handleClick","login","scope","state","isLoading","setState","error","alert","data","email","token","accessToken","expiresIn","expires_at","Date","getTime","user","federatedSignIn","onLogin"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,IAAT,QAAqB,aAArB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;;AAEA,SAASC,WAAT,GAAuB;AACrB,SAAO,IAAIC,OAAJ,CAAY,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC/B,QAAMC,WAAW,GAAG,SAAdA,WAAc,GAAM;AACxB,UAAIC,MAAM,CAACC,EAAX,EAAe;AACbJ,QAAAA,GAAG;AACJ,OAFD,MAEO;AACLK,QAAAA,UAAU,CAACH,WAAD,EAAc,GAAd,CAAV;AACD;AACF,KAND;;AAOAA,IAAAA,WAAW;AACZ,GATM,CAAP;AAUD;;IAEoBI,c;;;;;AACnB,0BAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,wFAAMA,KAAN;;AADiB,UAanBC,oBAbmB,GAaI,UAAAC,QAAQ,EAAI;AACjC,UAAIA,QAAQ,CAACC,MAAT,KAAoB,WAAxB,EAAqC;AACnC,cAAKC,cAAL,CAAoBF,QAAQ,CAACG,YAA7B;AACD,OAFD,MAEO;AACL,cAAKC,WAAL,CAAiBJ,QAAjB;AACD;AACF,KAnBkB;;AAAA,UAqBnBK,eArBmB,GAqBD,YAAM;AACtBX,MAAAA,MAAM,CAACC,EAAP,CAAUW,cAAV,CAAyB,MAAKP,oBAA9B;AACD,KAvBkB;;AAAA,UAyBnBQ,WAzBmB,GAyBL,YAAM;AAClBb,MAAAA,MAAM,CAACC,EAAP,CAAUa,KAAV,CAAgB,MAAKH,eAArB,EAAsC;AAACI,QAAAA,KAAK,EAAE;AAAR,OAAtC;AACD,KA3BkB;;AAGjB,UAAKC,KAAL,GAAa;AACXC,MAAAA,SAAS,EAAE;AADA,KAAb;AAHiB;AAMlB;;;;;;;;;;;;;uBAGOtB,WAAW,E;;;AACjB,qBAAKuB,QAAL,CAAc;AAAED,kBAAAA,SAAS,EAAE;AAAb,iBAAd;;;;;;;;;;;;;;;;gCAmBUE,K,EAAO;AACjBC,MAAAA,KAAK,CAACD,KAAD,CAAL;AACD;;;;;;iDAEoBE,I;;;;;;AACXC,gBAAAA,K,GAAyCD,I,CAAzCC,K,EAAoBC,K,GAAqBF,I,CAAlCG,W,EAAoBC,S,GAAcJ,I,CAAdI,S;AAC7BC,gBAAAA,U,GAAaD,SAAS,GAAG,IAAZ,GAAmB,IAAIE,IAAJ,GAAWC,OAAX,E;AAChCC,gBAAAA,I,GAAO;AAAEP,kBAAAA,KAAK,EAALA;AAAF,iB;AAEb,qBAAKJ,QAAL,CAAc;AAAED,kBAAAA,SAAS,EAAE;AAAb,iBAAd;;;uBAGyBxB,IAAI,CAACqC,eAAL,CACrB,UADqB,EAErB;AAAEP,kBAAAA,KAAK,EAALA,KAAF;AAASG,kBAAAA,UAAU,EAAVA;AAAT,iBAFqB,EAGrBG,IAHqB,C;;;AAAjBvB,gBAAAA,Q;AAKN,qBAAKY,QAAL,CAAc;AAAED,kBAAAA,SAAS,EAAE;AAAb,iBAAd;AACA,qBAAKb,KAAL,CAAW2B,OAAX,CAAmBzB,QAAnB;;;;;;;AAEA,qBAAKY,QAAL,CAAc;AAAED,kBAAAA,SAAS,EAAE;AAAb,iBAAd;AACA,qBAAKP,WAAL;;;;;;;;;;;;;;;;6BAIK;AACP,aACE,oBAAC,YAAD;AACE,QAAA,KAAK,MADP;AAEE,QAAA,MAAM,EAAC,OAFT;AAGE,QAAA,OAAO,EAAC,SAHV;AAIE,QAAA,SAAS,EAAC,gBAJZ;AAKE,QAAA,IAAI,EAAC,qBALP;AAME,QAAA,OAAO,EAAE,KAAKG,WANhB;AAOE,QAAA,QAAQ,EAAE,KAAKG,KAAL,CAAWC,SAPvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF;AAWD;;;;EAnEyCzB,S;;SAAvBW,c","sourcesContent":["import React, { Component } from \"react\";\nimport { Auth } from \"aws-amplify\";\nimport LoaderButton from \"./LoaderButton\";\n\nfunction waitForInit() {\n  return new Promise((res, rej) => {\n    const hasFbLoaded = () => {\n      if (window.FB) {\n        res();\n      } else {\n        setTimeout(hasFbLoaded, 300);\n      }\n    };\n    hasFbLoaded();\n  });\n}\n\nexport default class FacebookButton extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLoading: true\n    };\n  }\n\n  async componentDidMount() {\n    await waitForInit();\n    this.setState({ isLoading: false });\n  }\n\n  statusChangeCallback = response => {\n    if (response.status === \"connected\") {\n      this.handleResponse(response.authResponse);\n    } else {\n      this.handleError(response);\n    }\n  };\n\n  checkLoginState = () => {\n    window.FB.getLoginStatus(this.statusChangeCallback);\n  };\n\n  handleClick = () => {\n    window.FB.login(this.checkLoginState, {scope: \"public_profile,email\"});\n  };\n\n  handleError(error) {\n    alert(error);\n  }\n\n  async handleResponse(data) {\n    const { email, accessToken: token, expiresIn } = data;\n    const expires_at = expiresIn * 1000 + new Date().getTime();\n    const user = { email };\n\n    this.setState({ isLoading: true });\n\n    try {\n      const response = await Auth.federatedSignIn(\n        \"facebook\",\n        { token, expires_at },\n        user\n      );\n      this.setState({ isLoading: false });\n      this.props.onLogin(response);\n    } catch (e) {\n      this.setState({ isLoading: false });\n      this.handleError(e);\n    }\n  }\n\n  render() {\n    return (\n      <LoaderButton\n        block\n        bsSize=\"large\"\n        bsStyle=\"primary\"\n        className=\"FacebookButton\"\n        text=\"Login with Facebook\"\n        onClick={this.handleClick}\n        disabled={this.state.isLoading}\n      />\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}